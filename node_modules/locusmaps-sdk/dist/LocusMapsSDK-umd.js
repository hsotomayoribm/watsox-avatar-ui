!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e="undefined"!=typeof globalThis?globalThis:e||self).LMInit=n()}(this,function(){"use strict";function e(e){this._observers.splice(this._observers.indexOf(e),1)}function n(e){const n=o();return this.observe(function(){e.apply(this,arguments)&&n.fire.apply(n,arguments)}),n}const t={detach:e,filter:n,fire:function(){const e=this._observers;if(e){for(let n=0;n<e.length;n++)try{e[n].apply(this,arguments)}catch(e){console.error(e)}return this}},observe:function(n){return this._observers||(this._observers=[]),this._observers.push(n),{detach:e.bind(this,n),ob:this}},on:function(e,t){return function(e){return n.call(this,function(n){return e===n})}.call(this,e).observe(t)}};function o(e){return e?function(e,n){for(var t in n)e[t]=n[t];return e}(e,t):Object.create(t)}let s="https://maps.locuslabs.com/sdk/dist/current/",r=null,i=1;const c={};let a=!1;const d=[`%cLocusMaps SDK %c(${(()=>{const e=new Date;return`${e.getMinutes()}:${e.getSeconds()}.${e.getMilliseconds()}`})()})%c: `,"color: orange","font-size: 8px","font-size: inherit; color: inherit"],l=function(){a&&console.log.apply(null,d.concat(Array.from(arguments)))};function u(e){const n=e.data;n&&"LL-server"===n.type&&(n.clientMsgId?(n.error?l("Received error message",n.payload):l("Received message",n.payload),c[n.clientMsgId]&&(n.error?c[n.clientMsgId].reject(n.payload):c[n.clientMsgId].resolve(n.payload))):n.event&&r.fire(n.event,n.payload))}let f=null;const p={getVersion:()=>"1.1.0",newMap:function(e,n,t){const a=()=>window.postMessage({type:"LL-INIT",config:{...n,renderDiv:e}},"*");return t&&(s=t),new Promise((e,n)=>{r?(f.detach(),a(),f=r.on("ready",()=>{e(r)})):(window.addEventListener("message",u,!1),o(r=((e,n)=>{"string"==typeof e&&(e={...n,command:e});const t={payload:e,type:"LL-client",msgId:i++};return l("Sending command object: ",e),window.postMessage(t,"*"),new Promise((e,n)=>{c[t.msgId]={resolve:e,reject:n}})})),function(e){window.LLpublicPath=s;const n=document.createElement("script");n.setAttribute("src",s+"main.js"),document.head.appendChild(n),n.addEventListener("load",e)}(a),f=r.on("ready",(t,o)=>{const{commands:s}=o.commandJSON;try{d=r,s.forEach(e=>{d[e.command]=function(){const n={command:e.command};for(let t=0;t<arguments.length;t++)n[e.args[t].name]=arguments[t];return d(n)}}),r=d}catch(e){n(e)}l("map ready"),r.observe(function(){const e=Array.from(arguments);e.unshift("Event: "),l.apply(null,e)}),r.setLogging=p.setLogging,e(r)}))});var d},setLogging:e=>{a=e}};return p});
